import urllib
import urllib.request
import urllib.error
import json
import sys
hash_value = sys.argv[1]
vt_url = 'https://www.virustotal.com/vtapi/v2/file/report'
apiKey = "42012a1f26747a993bb0c20e6f845f2e806b63c18ddfd178d32656c3c388d91f"
api_key = apiKey
parameters = {'apikey': api_key, 'resource': hash_value}
encoded_parameters = urllib.parse.urlencode(parameters).encode("utf-8")
request = urllib.request.Request(vt_url, encoded_parameters)
response = urllib.request.urlopen(request)
json_response = json.loads(response.read())
if json_response['response_code']:
    detections = json_response['positives']
    total = json_response['total']
    scan_results = json_response['scans']
    print ("Detections: %s/%s" % (detections, total))
    print ("VirusTotal Results:")
    for av_name, av_data in scan_results.items():
        print ("\t%s ==> %s" % (av_name, av_data['result']))
else:
    print ("No AV Detections For: %s" % hash_value)